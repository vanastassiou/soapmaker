/* ============================================
   Soap Maker - Component Styles
   ============================================

   Note: This file is imported by main.css
   Variables are defined in tokens/_variables.css
   Utilities are defined in utilities/_utilities.css

   ============================================ */

/* Skip link for keyboard navigation */
.skip-link {
    position: absolute;
    top: -40px;
    left: 0;
    background: var(--accent-gold);
    color: var(--bg-primary);
    padding: var(--space-2) var(--space-4);
    z-index: 10000;
    font-weight: 600;
    text-decoration: none;
    border-radius: 0 0 var(--radius-sm) 0;
    transition: top 0.2s;
}

.skip-link:focus {
    top: 0;
    outline: 2px solid var(--accent-green);
    outline-offset: 2px;
}

body {
    font-family: var(--font-body);
    background: var(--bg-primary);
    color: var(--text-primary);
    min-height: 100vh;
    line-height: 1.6;
}

.container {
    max-width: 1200px;
    margin-left: auto;
    margin-right: auto;
    padding-top: var(--space-14);
    padding-bottom: var(--space-14);
    padding-left: 2rem;
    padding-right: 2rem;
}

header {
    text-align: center;
    margin-bottom: var(--space-12);
    padding: var(--space-8) 0;
    border-bottom: 1px solid var(--border);
}

h1 {
    font-family: var(--font-display);
    font-size: var(--text-7xl);
    font-weight: 400;
    color: var(--accent-cream);
    letter-spacing: 0.02em;
    margin-bottom: var(--space-2);
}

header p {
    color: var(--text-secondary);
    font-size: var(--text-3xl);
}

.header-nav {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: var(--space-2);
    margin-top: var(--space-3);
}

.header-link {
    color: var(--text-secondary);
    text-decoration: none;
    font-size: var(--text-base);
    text-transform: uppercase;
    letter-spacing: 0.08em;
    padding: var(--space-2) var(--space-4);
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    transition: all 0.2s;
}

.header-link:hover {
    color: var(--text-primary);
    border-color: var(--text-secondary);
}

.header-link:active {
    color: var(--text-primary);
    border-color: var(--text-secondary);
    background: transparent;
}

.header-link[aria-current="page"] {
    color: var(--text-primary);
    background: var(--bg-secondary);
    border-color: var(--text-secondary);
}

/* Prevent mobile tap highlight from persisting */
.header-link {
    -webkit-tap-highlight-color: transparent;
}

.kofi-button {
    position: absolute;
    top: 1rem;
    left: 50%;
    transform: translateX(-50%);
    z-index: 100;
    display: inline-flex;
    align-items: center;
    gap: var(--space-2);
    background: var(--accent-gold);
    color: var(--bg-primary);
    text-decoration: none;
    font-size: var(--text-md);
    font-weight: 600;
    padding: var(--space-2) var(--space-4);
    border-radius: var(--radius-md);
    transition: all 0.2s;
}

.kofi-button:hover {
    background: var(--accent-copper);
}

.kofi-icon {
    width: 18px;
    height: 18px;
    min-width: 18px;
    min-height: 18px;
    max-width: 18px;
    max-height: 18px;
    flex-shrink: 0;
}

.main-grid {
    display: block;
    max-width: 800px;
    margin: 0 auto;
}

.main-grid > * {
    min-width: 0;
}

@media (max-width: 768px) {
    .analysis-grid {
        grid-template-columns: 1fr;
    }

    .property-header {
        flex-wrap: wrap;
    }

    .property-options {
        order: 1;
        width: 100%;
    }

    .info-panel {
        width: 85%;
        max-width: 360px;
        right: -100%;
        padding: var(--space-5);
    }
}

.card {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: var(--radius-xl);
    padding: var(--space-5);
    margin-bottom: var(--space-6);
    overflow: hidden;
    max-width: 100%;
}

select, input, button {
    max-width: 100%;
}

.card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-5);
    padding-bottom: var(--space-3);
    border-bottom: 1px solid var(--border);
}

.card-title {
    font-family: var(--font-display);
    font-size: var(--text-4xl);
    color: var(--accent-cream);
}

.settings-row {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-4);
    margin-bottom: var(--space-4);
}

.settings-row .form-group {
    min-width: 140px;
    max-width: 180px;
    flex: 0 1 auto;
}

.form-group {
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
}

label {
    font-size: var(--text-md);
    color: var(--text-secondary);
    font-weight: 500;
}

.field-helper {
    font-size: var(--text-sm);
    color: var(--text-muted);
    margin-top: -0.2rem;
}

.label-row {
    display: flex;
    align-items: center;
    gap: var(--space-2);
}

.label-row .help-tip {
    font-size: var(--text-base);
}

input, select {
    background: var(--bg-input);
    border: 1px solid var(--border);
    border-radius: var(--radius-md);
    padding: 0.6rem 0.8rem;
    color: var(--text-primary);
    font-family: var(--font-mono);
    font-size: var(--text-xl);
    transition: border-color 0.2s, box-shadow 0.2s;
    width: 100%;
    min-height: var(--size-btn-md);
}

input:focus, select:focus {
    outline: none;
    border-color: var(--accent-gold);
    box-shadow: var(--focus-ring);
}

/* Global focus styles for keyboard accessibility */
:focus-visible {
    outline: 2px solid var(--accent-green);
    outline-offset: 2px;
}

button:focus-visible,
.btn:focus-visible {
    outline: none;
    box-shadow: var(--focus-ring-button);
}

.tab:focus-visible {
    outline: none;
    box-shadow: var(--focus-ring);
}

.fat-selector {
    display: flex;
    gap: var(--space-2);
    margin-bottom: var(--space-4);
}

.fat-selector select {
    flex: 1;
}

/* Property mode (matches fat-selector pattern) */
.property-header {
    display: flex;
    gap: var(--space-3);
    margin-bottom: var(--space-3);
    align-items: center;
}

.property-options {
    display: flex;
    gap: var(--space-4);
    font-size: var(--text-md);
    color: var(--text-secondary);
    align-items: center;
    flex: 1;
}

.property-options label {
    display: flex;
    align-items: center;
    gap: var(--space-1);
    cursor: pointer;
}

.property-options select {
    padding: 0.3rem 0.4rem;
    font-size: var(--text-md);
}

.property-options input[type="checkbox"] {
    width: 14px;
    height: 14px;
    accent-color: var(--accent-gold);
}

.property-options .help-tip {
    font-size: var(--text-base);
}

/* Mode Subcontainers (inside build-mode-content) */
.mode-subcontainer {
    margin-bottom: var(--space-4);
    padding-bottom: var(--space-4);
    border-bottom: 1px solid var(--border-30);
}

.mode-subcontainer:last-of-type {
    border-bottom: none;
    margin-bottom: 0;
    padding-bottom: 0;
}

.mode-subcontainer-title {
    font-size: var(--text-md);
    font-weight: 600;
    color: var(--text-secondary);
    margin-bottom: var(--space-3);
    text-transform: uppercase;
    letter-spacing: 0.03em;
}

/* Collapsible sections - native <details>/<summary> */
details.build-subcontainer > summary,
details.mode-subcontainer > summary {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    width: 100%;
    background: transparent;
    border: none;
    padding: 0;
    cursor: pointer;
    text-align: left;
    list-style: none;
}

details.build-subcontainer > summary::-webkit-details-marker,
details.mode-subcontainer > summary::-webkit-details-marker {
    display: none;
}

details.build-subcontainer > summary .subcontainer-title,
details.mode-subcontainer > summary .mode-subcontainer-title {
    flex-grow: 1;
    margin-bottom: 0;
}

details.build-subcontainer > summary .reset-btn,
details.mode-subcontainer > summary .reset-btn {
    flex-shrink: 0;
}

details.build-subcontainer > summary .collapse-icon,
details.mode-subcontainer > summary .collapse-icon {
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-muted);
    transition: transform 0.2s ease;
}

details.build-subcontainer > summary .collapse-icon::before,
details.mode-subcontainer > summary .collapse-icon::before {
    content: '▶';
    font-size: var(--text-2xs);
}

details.build-subcontainer[open] > summary .collapse-icon,
details.mode-subcontainer[open] > summary .collapse-icon {
    transform: rotate(90deg);
}

details.build-subcontainer > .collapsible-content,
details.mode-subcontainer > .collapsible-content {
    margin-top: var(--space-3);
}

.property-list {
    display: flex;
    flex-direction: column;
    gap: var(--space-3);
    margin-bottom: var(--space-3);
}

.property-row {
    display: grid;
    grid-template-columns: 1fr auto;
    gap: var(--space-3);
    align-items: center;
    padding: var(--space-3);
    background: var(--bg-secondary);
    border-radius: var(--radius-lg);
    border: 1px solid var(--border);
}

.property-row .info-link {
    font-size: var(--text-lg);
}

.property-row input {
    width: 80px;
    height: var(--size-icon-btn);
    min-height: var(--size-icon-btn);
    padding: var(--space-1) var(--space-2);
    text-align: center;
    font-size: var(--text-lg);
}

.property-row input::placeholder {
    color: var(--text-muted);
    font-size: var(--text-sm);
}

.property-row.property-action {
    justify-content: flex-end;
    margin-top: var(--space-1);
}

ol.instructions {
    color: var(--text-secondary);
    padding-left: 1.25rem;
    margin: 0 0 1rem 0;
}

ol.instructions li {
    margin-bottom: var(--space-1);
}

ol.instructions li:last-child {
    margin-bottom: 0;
}

.btn {
    background: var(--accent-gold);
    color: var(--bg-primary);
    border: none;
    border-radius: var(--radius-md);
    padding: var(--space-2) var(--space-4);
    font-family: var(--font-body);
    font-weight: 600;
    font-size: var(--text-lg);
    cursor: pointer;
    transition: background 0.2s, transform 0.1s, box-shadow 0.2s;
    min-height: var(--size-btn-md);
}

.btn:hover {
    background: var(--accent-copper);
}

.btn:active {
    transform: scale(0.98);
}

.btn-secondary {
    background: var(--bg-secondary);
    color: var(--text-primary);
    border: 1px solid var(--border);
}

.btn-secondary:hover {
    background: var(--border);
    color: var(--text-primary);
}

.btn-danger {
    background: var(--danger);
    color: #1a1714;  /* dark text for 5.5:1 contrast */
    font-weight: 600;
}

.btn-small {
    padding: var(--space-1) var(--space-3);
    font-size: var(--text-md);
    min-height: var(--size-btn-sm);
}

.recipe-fats,
.recipe-additives {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(min(280px, 100%), 1fr));
    gap: var(--space-3);
}

/* Full-width rows in grid containers */
.recipe-fats > .header-row,
.recipe-fats > .totals-row,
.recipe-fats > .empty-state,
.recipe-additives > .header-row,
.recipe-additives > .totals-row,
.recipe-additives > .empty-state {
    grid-column: 1 / -1;
}

/* Item rows - base styles */
.item-row {
    display: grid;
    grid-template-columns: 1fr auto auto auto;
    gap: var(--space-2);
    align-items: center;
    padding: var(--space-3);
    background: var(--bg-secondary);
    border-radius: var(--radius-lg);
    border: 1px solid var(--border);
}

/* Column layout variants */
.item-row.cols-4 {
    grid-template-columns: 1fr auto auto auto;
}

.item-row.cols-3 {
    grid-template-columns: 1fr auto auto;
}

.item-row.cols-2 {
    grid-template-columns: 1fr auto;
}

.item-row.locked {
    border-color: var(--accent-gold);
    background: var(--accent-gold-10);
}

.item-row.header-row {
    background: transparent;
    border: none;
    padding: var(--space-1) var(--space-3);
    font-size: var(--text-md);
    color: var(--text-muted);
    font-weight: 500;
}

.item-row.header-row span {
    text-align: center;
}

.item-row.header-row span:first-child {
    text-align: left;
}

/* Weight and percentage cells with inline lock buttons */
.weight-cell,
.percentage-cell {
    display: flex;
    align-items: center;
    justify-content: flex-end;
    justify-self: end;
    gap: var(--space-2);
}

.weight-cell input,
.percentage-cell input {
    flex: 1;
    min-width: 0;
    max-width: 5rem;
}

/* Icon buttons - shared base (lock, remove) */
.icon-btn {
    background: transparent;
    width: var(--size-icon-btn);
    height: var(--size-icon-btn);
    border-radius: var(--radius-sm);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: var(--text-xl);
    line-height: 1;
    transition: all 0.2s;
    flex-shrink: 0;
}

/* Lock buttons */
.lock-btn {
    background: transparent;
    border: 1px solid var(--border);
    color: var(--text-muted);
}

.lock-btn:hover {
    border-color: var(--accent-green);
    color: var(--accent-green);
}

.lock-btn.locked {
    background: var(--accent-gold);
    border-color: var(--accent-gold);
    color: var(--bg-primary);
}

/* Item name buttons */
.item-name {
    font-weight: 500;
    color: var(--text-primary);
    /* Button reset for semantic button elements */
    background: none;
    border: none;
    padding: 0;
    font: inherit;
    text-align: left;
}

/* Clickable text elements */
.clickable {
    cursor: pointer;
    transition: color 0.2s;
}

.clickable:hover {
    color: var(--accent-green);
}

/* Item row inputs and percentages */
.item-row input {
    width: 4rem;
    height: var(--size-icon-btn);
    min-height: var(--size-icon-btn);
    padding: var(--space-1) var(--space-2);
    font-size: var(--text-lg);
    text-align: right;
}

.item-row input[data-action="percentage"] {
    width: 3rem;
}

.item-row input:disabled {
    background: var(--bg-primary);
    color: var(--text-muted);
    cursor: not-allowed;
    opacity: 0.7;
}

.item-percentage {
    font-family: var(--font-mono);
    color: var(--text-secondary);
    font-size: var(--text-lg);
    text-align: right;
}

/* Remove buttons */
.remove-btn {
    justify-self: end;
    background: transparent;
    border: 1px solid var(--danger);
    color: var(--danger);
}

.remove-btn:hover {
    background: var(--danger);
    border-color: var(--danger);
    color: var(--bg-primary);
}

.totals-row {
    display: grid;
    grid-template-columns: 1fr auto auto auto;
    gap: var(--space-2);
    padding: var(--space-3);
    background: var(--bg-primary);
    color: var(--text-secondary);
    border-radius: 0;
    border: none;
    border-top: 1px solid var(--border);
    font-weight: 600;
    margin-top: var(--space-2);
    font-family: var(--font-mono);
    font-size: var(--text-lg);
}

.totals-row span:nth-child(2),
.totals-row span:nth-child(3) {
    text-align: right;
}

/* Generic Tab Styles */
.tabs {
    display: flex;
    gap: var(--space-2);
    margin-bottom: var(--space-4);
}

.tab {
    flex: 1;
    background: var(--bg-secondary);
    border: 1px solid var(--border);
    border-radius: var(--radius-md);
    padding: var(--space-2) var(--space-4);
    color: var(--text-secondary);
    cursor: pointer;
    font-family: var(--font-body);
    font-size: var(--text-lg);
    font-weight: 500;
    transition: all 0.2s;
    min-height: var(--size-btn-md);
}

.tab:hover {
    border-color: var(--accent-gold);
    color: var(--text-primary);
}

.tab.active {
    background: var(--accent-gold);
    border-color: var(--accent-gold);
    color: var(--bg-primary);
}

/* Analysis Subcontainers */
.analysis-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--space-4);
    margin-bottom: var(--space-4);
}

.analysis-subcontainer {
    background: var(--bg-secondary);
    border-radius: var(--radius-lg);
    padding: var(--space-4);
    border: 1px solid var(--border);
}

.subcontainer-title {
    font-family: var(--font-display);
    font-size: var(--text-2xl);
    color: var(--text-primary);
    margin: 0 0 0.75rem 0;
    font-weight: 400;
}

.analysis-table {
    width: 100%;
    border-collapse: collapse;
    font-size: var(--text-lg);
    table-layout: fixed;
}

.analysis-table th {
    text-align: left;
    color: var(--text-secondary);
    font-weight: 500;
    font-size: var(--text-base);
    padding: var(--space-2) var(--space-2);
    border-bottom: 1px solid var(--border);
}

.analysis-table td {
    padding: var(--space-2) var(--space-2);
    color: var(--text-primary);
    border-bottom: 1px solid var(--border-30);
}

.analysis-table tr:last-child td {
    border-bottom: none;
}

.analysis-table .range-col {
    text-align: center;
    color: var(--text-secondary);
    font-family: var(--font-mono);
    font-size: var(--text-base);
}

.analysis-table .value-col {
    text-align: center;
    font-family: var(--font-mono);
    font-weight: 600;
    color: var(--accent-cream);
}

.analysis-table .value-col.in-range {
    color: var(--success);
}

.analysis-table .value-col.in-range::before {
    content: "✓ ";
    font-size: 0.75em;
}

.analysis-table .value-col.out-range {
    color: var(--warning);
}

.range-tip {
    margin-left: 0.25rem;
    color: var(--warning);
}

.fa-table td:first-child {
    width: 70%;
}

.fa-table .fa-value {
    text-align: right;
    font-family: var(--font-mono);
    font-weight: 500;
    color: var(--accent-cream);
}

.sat-unsat-ratio {
    display: flex;
    justify-content: space-between;
    margin-top: var(--space-3);
    padding-top: var(--space-3);
    border-top: 1px solid var(--border);
    font-size: var(--text-lg);
}

.sat-unsat-ratio span:first-child {
    color: var(--text-secondary);
}

.sat-unsat-ratio span:last-child {
    font-family: var(--font-mono);
    font-weight: 600;
    color: var(--accent-gold);
}

/* Info links (data terms - open sidebar panels) */
.info-link {
    cursor: pointer;
    transition: color 0.2s;
    /* WCAG 2.2 Target Size: ensure adequate touch target */
    display: inline-flex;
    align-items: center;
    min-height: 24px;
    /* Button reset for semantic button elements */
    background: none;
    border: none;
    padding: 0;
    font: inherit;
    color: inherit;
}

.info-link:hover {
    color: var(--accent-green);
}

/* Help tips (UI metadata - show tooltips) */
.help-tip {
    cursor: help;
    color: var(--text-muted);
    font-size: 0.85em;
    transition: color 0.2s;
    /* WCAG 2.2 Target Size: minimum 24x24px touch target */
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 24px;
    min-height: 24px;
}

.help-tip:hover {
    color: var(--accent-green);
}

/* Panel tags for related terms */
.panel-tags {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-2);
}

.panel-tag {
    padding: 0.375rem 0.75rem;
    background: var(--bg-secondary);
    border-radius: var(--radius-sm);
    font-size: var(--text-md);
    color: var(--text-secondary);
    cursor: pointer;
    transition: all 0.2s;
    /* WCAG 2.2 Target Size: minimum 24x24px */
    min-height: 24px;
    display: inline-flex;
    align-items: center;
    /* Button reset for semantic button elements */
    border: none;
    font-family: inherit;
}

.panel-tag:hover {
    background: var(--accent-green);
    color: var(--bg-primary);
}

/* Panel references */
.panel-references {
    display: flex;
    flex-direction: column;
    gap: var(--space-3);
}

.reference-item {
    display: flex;
    flex-direction: column;
    gap: var(--space-1);
}

.reference-item a {
    color: var(--accent-green);
    text-decoration: none;
    font-size: var(--text-lg);
}

.reference-item a:hover {
    text-decoration: underline;
}

.reference-section {
    font-size: var(--text-base);
    color: var(--text-muted);
}

.glossary-tooltip {
    position: absolute;
    max-width: 320px;
    background: var(--bg-primary);
    border: 1px solid var(--accent-gold);
    border-radius: var(--radius-lg);
    padding: var(--space-4);
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
    z-index: 1000;
    display: none;
    font-size: var(--text-lg);
}

.glossary-tooltip.visible {
    display: block;
}

.tooltip-header {
    font-weight: 600;
    color: var(--accent-green);
    margin-bottom: var(--space-2);
    font-size: var(--text-xl);
}

.tooltip-category {
    display: inline-block;
    font-size: var(--text-xs);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--bg-primary);
    background: var(--text-secondary);
    padding: 0.1rem 0.4rem;
    border-radius: var(--radius-sm);
    margin-left: 0.5rem;
    vertical-align: middle;
}

.tooltip-body {
    color: var(--text-primary);
    line-height: 1.5;
    margin-bottom: var(--space-2);
}

.tooltip-details {
    margin-bottom: var(--space-2);
}

.entry-details summary {
    list-style: none;
    cursor: pointer;
}

.tooltip-details summary::-webkit-details-marker,
.entry-details summary::-webkit-details-marker {
    display: none;
}

.details-toggle,
.details-hide {
    font-size: var(--text-base);
    color: var(--accent-gold);
}

.details-toggle::before,
.details-hide::before {
    content: '▶';
    display: inline-block;
    margin-right: 0.4rem;
    font-size: 0.6em;
    transition: transform 0.2s;
}

details[open] .details-toggle::before,
.details-hide::before {
    transform: rotate(90deg);
}

.details-toggle:hover,
.details-hide:hover {
    text-decoration: underline;
}

.details-toggle {
    display: inline;
}

.details-hide {
    display: none;
}

details[open] .details-toggle {
    display: none;
}

details[open] .details-hide {
    display: inline;
}

.tooltip-details-content {
    font-size: var(--text-md);
    color: var(--text-secondary);
    margin-top: var(--space-2);
    padding: var(--space-2);
    background: var(--bg-secondary);
    border-radius: var(--radius-sm);
}

.tooltip-details-content strong {
    color: var(--accent-cream);
}

.tooltip-related {
    padding-top: var(--space-2);
    border-top: 1px solid var(--border);
    font-size: var(--text-base);
}

.tooltip-related-label {
    color: var(--text-secondary);
    margin-bottom: var(--space-1);
}

.related-term {
    display: inline-flex;
    align-items: center;
    color: var(--accent-cream);
    background: var(--bg-secondary);
    padding: var(--space-1) var(--space-2);
    border-radius: var(--radius-sm);
    margin: 0.2rem 0.25rem 0.2rem 0;
    cursor: pointer;
    transition: background 0.2s;
    border: 1px solid var(--border);
    /* WCAG 2.2 Target Size: minimum 24x24px */
    min-height: 24px;
}

.related-term:hover {
    background: var(--accent-green);
    color: var(--bg-primary);
    border-color: var(--accent-green);
    font-weight: 500;
}

/* UI Tips (question mark icons for site usage help) */
.ui-tip {
    cursor: help;
    color: var(--text-muted);
    font-size: var(--text-sm);
    font-weight: 600;
    transition: color 0.2s, border-color 0.2s;
    /* WCAG 2.2 Target Size: minimum 24x24px */
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 24px;
    min-height: 24px;
    width: 18px;
    height: 18px;
    border: 1px solid var(--border);
    border-radius: 50%;
    background: var(--bg-secondary);
    vertical-align: middle;
    margin-left: 0.25rem;
}

.ui-tip:hover {
    color: var(--accent-gold);
    border-color: var(--accent-gold);
}

/* Help Popup (shared by glossary and tooltips) */
.help-popup {
    position: absolute;
    max-width: 280px;
    background: var(--bg-primary);
    border: 1px solid var(--accent-gold);
    border-radius: var(--radius-md);
    padding: var(--space-3);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.4);
    z-index: 1000;
    display: none;
    font-size: var(--text-md);
}

.help-popup.visible {
    display: block;
}

.help-popup-title {
    font-weight: 600;
    color: var(--accent-green);
    margin-bottom: var(--space-1);
    font-size: var(--text-lg);
}

.help-popup-body {
    color: var(--text-primary);
    line-height: 1.5;
    margin-bottom: var(--space-2);
}

.help-popup-link {
    display: none;
    font-size: var(--text-base);
    color: var(--accent-gold);
    text-decoration: none;
    cursor: pointer;
}

.help-popup-link:hover {
    text-decoration: underline;
}

/* Properties Grid (legacy support) */
.properties-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--space-3);
}

.property-item {
    background: var(--bg-secondary);
    padding: var(--space-3);
    border-radius: var(--radius-lg);
    border: 1px solid var(--border);
}

.property-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-2);
}

.property-name {
    font-size: var(--text-md);
    color: var(--text-secondary);
}

.property-value {
    font-family: var(--font-mono);
    font-weight: 600;
    color: var(--accent-cream);
}

.property-bar {
    height: 6px;
    background: var(--bg-input);
    border-radius: var(--radius-sm);
    overflow: hidden;
}

.property-fill {
    height: 100%;
    background: var(--accent-gold);
    border-radius: var(--radius-sm);
    transition: width 0.3s ease;
}

.property-fill.low {
    background: repeating-linear-gradient(
        -45deg,
        var(--danger),
        var(--danger) 3px,
        transparent 3px,
        transparent 6px
    ),
    var(--danger);
}
.property-fill.mid { background: var(--accent-gold); }
.property-fill.high { background: var(--success); }

.fatty-acids {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--space-2);
}

.fatty-acid-item {
    display: flex;
    justify-content: space-between;
    padding: var(--space-2) var(--space-3);
    background: var(--bg-secondary);
    border-radius: var(--radius-md);
    font-size: var(--text-lg);
}

.fatty-acid-name {
    color: var(--text-secondary);
}

.fatty-acid-value {
    font-family: var(--font-mono);
    color: var(--accent-cream);
}

/* Info Panel */
.info-panel {
    position: fixed;
    top: 0;
    right: -450px;
    width: 450px;
    height: 100vh;
    background: var(--bg-card);
    border-left: 1px solid var(--border);
    padding: var(--space-8);
    overflow-y: auto;
    transition: right 0.3s ease;
    z-index: 1000;
}

.info-panel.open {
    right: 0;
}

.panel-title {
    font-family: var(--font-display);
    font-size: var(--text-5xl);
    color: var(--accent-cream);
    margin-bottom: var(--space-2);
    padding-right: 3rem;
}

.panel-subtitle {
    font-family: var(--font-mono);
    color: var(--accent-gold);
    margin-bottom: var(--space-6);
}

.panel-section {
    margin-bottom: var(--space-6);
}

.panel-section h4 {
    font-size: var(--text-md);
    color: var(--text-secondary);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: var(--space-3);
}

.panel-description {
    color: var(--text-secondary);
    line-height: 1.7;
}

.panel-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: var(--shadow-overlay);
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s;
    z-index: 999;
}

.panel-overlay.open {
    opacity: 1;
    visibility: visible;
}

/* WCAG 2.2 Focus Not Obscured: visual indication of inert content */
[inert] {
    pointer-events: none;
    user-select: none;
}

.close-panel {
    position: absolute;
    top: 1rem;
    right: 1rem;
    background: transparent;
    border: 1px solid var(--border);
    color: var(--text-secondary);
    width: 36px;
    height: 36px;
    border-radius: var(--radius-md);
    cursor: pointer;
    font-size: var(--text-4xl);
}

.fat-detail-title {
    font-family: var(--font-display);
    font-size: var(--text-5xl);
    color: var(--accent-cream);
    margin-bottom: var(--space-2);
    padding-right: 3rem;
}

.fat-detail-sap {
    font-family: var(--font-mono);
    color: var(--accent-gold);
    margin-bottom: var(--space-6);
}

.fat-detail-section {
    margin-bottom: var(--space-6);
}

.fat-detail-section h4 {
    font-size: var(--text-md);
    color: var(--text-secondary);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: var(--space-3);
}

.fat-detail-description {
    color: var(--text-secondary);
    line-height: 1.7;
}

.usage-rate {
    display: inline-block;
    background: var(--accent-gold);
    color: var(--bg-primary);
    padding: var(--space-1) var(--space-3);
    border-radius: var(--radius-sm);
    font-size: var(--text-md);
    font-weight: 600;
}

.info-btn {
    background: transparent;
    border: 1px solid var(--border);
    color: var(--text-muted);
    width: 28px;
    height: 28px;
    border-radius: var(--radius-sm);
    cursor: pointer;
    font-size: var(--text-md);
    margin-left: 0.5rem;
    transition: all 0.2s;
}

.info-btn:hover {
    border-color: var(--accent-green);
    color: var(--accent-green);
}

/* Fatty Acid Panel */
.fa-chemistry {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--space-3);
}

.fa-chem-item {
    background: var(--bg-secondary);
    padding: var(--space-3);
    border-radius: var(--radius-md);
    border: 1px solid var(--border);
}

.fa-chem-label {
    font-size: var(--text-sm);
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: var(--space-1);
}

.fa-chem-value {
    font-family: var(--font-mono);
    color: var(--accent-cream);
    font-size: var(--text-2xl);
}

.fa-props-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--space-2);
    margin-bottom: var(--space-3);
}

.fa-prop-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: var(--bg-secondary);
    padding: var(--space-2) var(--space-3);
    border-radius: var(--radius-sm);
    border: 1px solid var(--border);
}

.fa-prop-label {
    font-size: var(--text-base);
    color: var(--text-muted);
}

.fa-prop-value {
    font-size: var(--text-md);
    color: var(--accent-cream);
}

.fa-description {
    color: var(--text-secondary);
    margin: 0;
    padding-top: var(--space-2);
    border-top: 1px solid var(--border);
}

.fa-sources,
.fa-common-sources {
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
}

.fa-source-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: var(--bg-secondary);
    padding: var(--space-2) var(--space-3);
    border-radius: var(--radius-sm);
    border: 1px solid var(--border);
}

.fa-source-name {
    color: var(--text-primary);
}

.fa-source-percent {
    font-family: var(--font-mono);
    color: var(--accent-gold);
    font-size: var(--text-lg);
}

.fa-common-sources .fa-source-item {
    border: 1px dashed var(--border);
    background: transparent;
}

.no-sources {
    color: var(--text-muted);
    font-style: italic;
    font-size: var(--text-lg);
}

.fa-link {
    cursor: pointer;
    transition: color 0.2s;
    /* WCAG 2.2 Target Size: ensure adequate touch target */
    display: inline-flex;
    align-items: center;
    min-height: 24px;
    /* Button reset for semantic button elements */
    background: none;
    border: none;
    padding: 0;
    font: inherit;
    color: inherit;
}

.fa-link:hover {
    color: var(--accent-green);
}

.empty-state {
    text-align: center;
    padding: var(--space-12);
    color: var(--text-muted);
}

.empty-state p {
    margin-bottom: var(--space-4);
}

.recipe-actions {
    display: flex;
    gap: var(--space-2);
    flex-wrap: wrap;
}

/* Responsive - Mobile (480px) */
@media (max-width: 480px) {
    .kofi-button {
        font-size: var(--text-sm);
        padding: 0.4rem 0.75rem;
        top: 0.5rem;
    }

    .container {
        padding-left: 0.75rem;
        padding-right: 0.75rem;
        padding-top: var(--space-12);
        padding-bottom: var(--space-12);
    }

    .card {
        padding: var(--space-4);
        border-radius: var(--radius-lg);
    }

    h1 {
        font-size: var(--text-6xl);
    }

    header p {
        font-size: var(--text-xl);
    }

    header {
        margin-bottom: var(--space-8);
        padding: 1.25rem 0;
    }

    .card-title {
        font-size: var(--text-3xl);
    }

    .item-row,
    .totals-row {
        gap: var(--space-1);
        padding: var(--space-2);
    }

    /* Collapse item rows to 2 columns with name spanning full width */
    .item-row.cols-4,
    .item-row.cols-3 {
        grid-template-columns: 1fr auto;
    }

    .item-row.cols-4 .item-name,
    .item-row.cols-3 .item-name {
        grid-column: 1 / -1;
    }

    .item-row input {
        width: 3.5rem;
    }

    .icon-btn {
        --size-icon-btn: 24px;
        font-size: var(--text-md);
    }

    .properties-grid,
    .fatty-acids {
        grid-template-columns: 1fr;
    }

    .fat-selector {
        flex-wrap: wrap;
    }

    .fat-selector select {
        width: 100%;
        flex: none;
    }

    .exclusion-header {
        flex-direction: column;
        align-items: flex-start;
        gap: var(--space-2);
    }

    .exclusion-add {
        width: 100%;
    }

    .exclusion-add select {
        min-width: 0;
        flex: 1;
    }

    .tabs {
        flex-direction: column;
    }

    .tab {
        width: 100%;
        text-align: center;
    }

    .analysis-table {
        font-size: var(--text-md);
    }

    .analysis-table th,
    .analysis-table td {
        padding: 0.35rem 0.3rem;
    }

    select, input {
        font-size: var(--text-lg);
        padding: 0.5rem 0.6rem;
    }

    .settings-row .form-group {
        min-width: 0;
        max-width: none;
        flex: 1 1 100%;
    }
}

/* Build Recipe Card */
.build-subcontainer {
    background: var(--bg-secondary);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    padding: var(--space-5);
    margin-bottom: var(--space-5);
}

.build-subcontainer .subcontainer-title {
    font-family: var(--font-display);
    font-size: var(--text-3xl);
    font-weight: 400;
    color: var(--text-secondary);
    margin-bottom: 0;
}

.subcontainer-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-4);
}

.btn-text {
    background: transparent;
    border: none;
    color: var(--text-muted);
    font-size: var(--text-base);
    padding: var(--space-1) var(--space-2);
    cursor: pointer;
}

.btn-text:hover {
    color: var(--accent-green);
}

/* Reset button positioning handled by flex layout in summary */

/* Unified build mode area */
.build-mode-area {
    background: var(--bg-tertiary);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    padding: var(--space-4);
    margin-bottom: var(--space-5);
}

.build-mode-tabs {
    margin-bottom: var(--space-4);
    gap: var(--space-2);
}

.build-mode-tab {
    padding: var(--space-2) var(--space-4);
    font-size: var(--text-lg);
    border-radius: var(--radius-md);
    min-height: var(--size-btn-md);
}

.build-mode-tab.active {
    background: var(--accent-green-20);
    border-color: var(--accent-green);
    color: var(--text-primary);
    font-weight: 600;
}

.build-mode-helper {
    color: var(--text-secondary);
    margin-bottom: var(--space-4);
}

.build-mode-helper.hidden {
    display: none;
}

.build-mode-content {
    /* No background/border - inherits from .build-mode-area */
}

.build-mode-content.hidden {
    display: none;
}

.build-mode-content .empty-state {
    padding: var(--space-4);
}

.build-mode-content .empty-state p {
    margin-bottom: 0;
}

.analysis-helper-text {
    color: var(--text-secondary);
    margin-bottom: var(--space-3);
    line-height: 1.5;
}

/* Fat Exclusions */
.build-exclusions {
    margin-top: var(--space-4);
    padding-top: var(--space-4);
    border-top: 1px solid var(--border);
}

.exclusion-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-2);
}

.exclusion-header > label {
    font-size: var(--text-md);
    color: var(--text-secondary);
}

.exclusion-specific {
    margin-top: var(--space-3);
}

.exclusion-label {
    display: block;
    font-size: var(--text-md);
    color: var(--text-secondary);
    margin-bottom: var(--space-2);
}

.exclusion-add {
    display: flex;
    gap: var(--space-2);
}

.exclusion-add select {
    flex: 1;
}

.excluded-fats-list {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 0.75rem 1.25rem;
    min-height: 1.5rem;
}

.excluded-fat-tag {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    font-size: var(--text-lg);
    color: var(--text-secondary);
}

.excluded-fat-tag:hover {
    color: var(--text-primary);
}

.excluded-fat-tag .remove-exclusion {
    background: none;
    border: none;
    color: var(--text-muted);
    cursor: pointer;
    padding: 0;
    font-size: var(--text-2xl);
    line-height: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    /* WCAG 2.2 Target Size: minimum 24x24px */
    min-width: 24px;
    min-height: 24px;
}

.excluded-fat-tag .remove-exclusion:hover {
    color: var(--danger);
}

/* Dietary Filters */
.dietary-filters {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 0.75rem 1.25rem;
    margin-top: var(--space-3);
    padding-top: var(--space-3);
    border-top: 1px solid var(--border-30);
}

.dietary-filters .filter-label {
    font-size: var(--text-md);
    color: var(--text-muted);
}

.dietary-filter {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    cursor: pointer;
    font-size: var(--text-lg);
    color: var(--text-secondary);
}

.dietary-filter:hover {
    color: var(--text-primary);
}

.dietary-filter input[type="checkbox"] {
    width: 16px;
    height: 16px;
    accent-color: var(--accent-gold);
    cursor: pointer;
}

.dietary-filter input[type="checkbox"]:checked + span {
    color: var(--text-primary);
}

.dietary-filter .help-tip {
    font-size: var(--text-base);
}

#generateRecipeBtn {
    width: 100%;
    padding: var(--space-3);
    font-size: var(--text-2xl);
}

.btn-primary {
    background: var(--accent-gold);
    color: var(--bg-primary);
}

.btn-primary:hover {
    background: var(--accent-copper);
}

/* Profile Results */
.profile-results {
    margin-top: var(--space-5);
    padding-top: var(--space-5);
    border-top: 1px solid var(--border);
}

.profile-results.hidden {
    display: none;
}

.match-quality {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    margin-bottom: var(--space-4);
}

.match-label {
    font-size: var(--text-md);
    color: var(--text-secondary);
    white-space: nowrap;
}

.match-bar {
    flex: 1;
    height: 8px;
    background: var(--bg-input);
    border-radius: var(--radius-sm);
    overflow: hidden;
}

.match-bar-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--danger), var(--warning), var(--success));
    border-radius: var(--radius-sm);
    transition: width 0.3s ease;
}

.match-percent {
    font-family: var(--font-mono);
    font-size: var(--text-lg);
    font-weight: 600;
    color: var(--accent-cream);
    min-width: 40px;
    text-align: right;
}

/* Action Button Containers */
.use-recipe-action,
.generate-action {
    margin-top: var(--space-4);
    padding-top: var(--space-4);
    border-top: 1px solid var(--border);
}

.use-recipe-action .btn,
.generate-action .btn {
    width: 100%;
}

.suggested-recipe {
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
    margin-bottom: var(--space-4);
}

.suggested-fat {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--space-2) var(--space-3);
    background: var(--bg-secondary);
    border-radius: var(--radius-md);
    margin-bottom: var(--space-2);
    font-size: var(--text-lg);
}

.suggested-fat-name {
    color: var(--text-primary);
}

.suggested-fat-name.clickable {
    cursor: pointer;
    transition: color 0.2s;
}

.suggested-fat-name.clickable:hover {
    color: var(--accent-green);
}

.suggested-fat-percent {
    font-family: var(--font-mono);
    font-weight: 600;
    color: var(--accent-gold);
}

.achieved-profile {
    margin-bottom: var(--space-4);
}

.achieved-profile h4 {
    font-size: var(--text-md);
    color: var(--text-secondary);
    margin-bottom: var(--space-2);
}

.achieved-comparison {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--space-2);
}

@media (max-width: 480px) {
    .achieved-comparison {
        grid-template-columns: 1fr;
    }
}

.achieved-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.4rem 0.6rem;
    background: var(--bg-secondary);
    border-radius: var(--radius-sm);
    font-size: var(--text-md);
    border-left: 3px solid var(--border);
}

.achieved-item.good {
    border-left-color: var(--success);
    background: rgba(90, 154, 138, 0.1);
}

.achieved-item.close {
    border-left-color: var(--warning);
}

.achieved-item.off {
    border-left-color: var(--danger);
    background: rgba(196, 122, 85, 0.1);
}

.achieved-acid {
    color: var(--text-secondary);
}

.achieved-values {
    font-family: var(--font-mono);
    color: var(--text-primary);
}

.achieved-values .target {
    color: var(--text-muted);
}

.achieved-values .arrow {
    color: var(--text-muted);
    margin: 0 0.25rem;
}

.achieved-values .achieved {
    color: var(--accent-cream);
}

.achieved-values .diff {
    font-size: var(--text-sm);
    margin-left: 0.25rem;
}

.achieved-values .diff.positive {
    color: var(--warning);
}

.achieved-values .diff.negative {
    color: var(--success);
}

#useRecipeBtn {
    width: 100%;
}

/* ============================================
   Shared Page Layout Components
   ============================================ */

/* Page container - narrow width for content pages */
.page-container {
    max-width: 900px;
}

/* Page header - centred with consistent spacing */
.page-header {
    text-align: center;
}

.page-header h1 {
    margin-bottom: var(--space-2);
}

/* Page intro text */
.page-intro {
    color: var(--text-secondary);
    font-size: var(--text-3xl);
    margin-bottom: var(--space-6);
}

/* Page summary (counts/stats below header) */
.page-summary {
    text-align: center;
    color: var(--text-muted);
    font-size: var(--text-lg);
    margin-bottom: var(--space-6);
    padding-bottom: var(--space-4);
    border-bottom: 1px solid var(--border);
}

/* Filter navigation */
.page-nav {
    display: flex;
    gap: var(--space-2);
    margin-bottom: var(--space-8);
    flex-wrap: wrap;
    justify-content: center;
}

/* Filter buttons */
.page-filter {
    background: var(--bg-secondary);
    border: 1px solid var(--border);
    border-radius: var(--radius-md);
    padding: var(--space-2) var(--space-4);
    color: var(--text-secondary);
    cursor: pointer;
    font-family: var(--font-body);
    font-size: var(--text-lg);
    transition: all 0.2s;
}

.page-filter:hover {
    border-color: var(--accent-gold);
    color: var(--text-primary);
}

.page-filter.active {
    background: var(--accent-gold);
    border-color: var(--accent-gold);
    color: var(--bg-primary);
}

/* Entry list container */
.page-list {
    display: flex;
    flex-direction: column;
    gap: var(--space-4);
}

/* Entry card base */
.entry-card {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    padding: var(--space-2) var(--space-4);
    transition: border-color 0.3s, box-shadow 0.3s;
}

.entry-card > *:last-child {
    margin-bottom: 0;
}

.entry-card.highlight {
    border-color: var(--accent-gold);
    box-shadow: 0 0 0 2px var(--accent-gold-20);
}

/* Entry header */
.entry-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-2);
    padding: 0 0 0.5rem 0;
    border-bottom: 1px solid var(--border);
}

/* Entry title */
.entry-title {
    font-family: var(--font-display);
    font-size: var(--text-4xl);
    color: var(--accent-cream);
    margin: 0;
}

/* Entry category badge */
.entry-category {
    font-size: var(--text-sm);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--bg-primary);
    background: var(--text-secondary);
    padding: 0.1rem 0.4rem;
    border-radius: var(--radius-sm);
}

/* Entry description */
.entry-desc {
    color: var(--text-primary);
    line-height: 1.6;
    margin-bottom: var(--space-3);
}

/* Entry expandable details */
.entry-details {
    margin-bottom: var(--space-2);
}

.entry-details summary {
    cursor: pointer;
    color: var(--accent-green);
    font-size: var(--text-lg);
    font-weight: 500;
    padding: 0.25rem 0;
    transition: color 0.2s;
}

.entry-details summary:hover {
    color: var(--accent-cream);
}

.entry-details-content {
    background: var(--bg-secondary);
    border-radius: var(--radius-md);
    padding: var(--space-3) var(--space-4);
    margin-top: var(--space-2);
    color: var(--text-secondary);
    font-size: var(--text-lg);
    line-height: 1.7;
}

/* Related terms/links */
.entry-related {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: var(--space-2);
    font-size: var(--text-md);
    margin-bottom: var(--space-3);
}

.entry-related-label {
    color: var(--text-muted);
}

.entry-related-link {
    color: var(--accent-cream);
    background: var(--bg-secondary);
    padding: 0.2rem 0.6rem;
    border-radius: var(--radius-sm);
    text-decoration: none;
    border: 1px solid var(--border);
    transition: all 0.2s;
}

.entry-related-link:hover {
    background: var(--accent-green);
    color: var(--bg-primary);
    border-color: var(--accent-green);
}

/* Entry title as link */
a.entry-title,
.entry-title-link {
    color: var(--accent-green);
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: var(--space-1);
}

a.entry-title:hover,
.entry-title-link:hover {
    text-decoration: underline;
}

.entry-title .external-icon,
.entry-title-link .external-icon {
    font-size: var(--text-base);
}

/* Entry metadata */
.entry-meta {
    font-size: var(--text-md);
    color: var(--text-secondary);
    margin-bottom: var(--space-3);
    display: flex;
    flex-direction: column;
    gap: var(--space-1);
}

.entry-meta-label {
    color: var(--text-muted);
    font-weight: 500;
}

/* Unified reference styling for all entry types */
.entry-references {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: var(--space-2);
    margin-top: var(--space-3);
    padding-top: var(--space-3);
    border-top: 1px solid var(--border-30);
    font-size: var(--text-md);
}

.references-label {
    color: var(--text-muted);
}

.reference-link {
    color: var(--accent-green);
    text-decoration: none;
}

.reference-link:hover {
    text-decoration: underline;
}

/* Learn more link */
.entry-learn-more {
    margin-top: var(--space-2);
}

.learn-more-link {
    color: var(--accent-green);
    font-size: var(--text-md);
    text-decoration: none;
}

.learn-more-link:hover {
    text-decoration: underline;
}

.no-results {
    text-align: center;
    color: var(--text-muted);
    padding: var(--space-12);
    font-style: italic;
}

/* ============================================
   Fats Page - Entry Styles
   ============================================ */

/* Fat-specific: header override for flex-start alignment */
.fat-entry-header { align-items: flex-start; gap: var(--space-3); }

/* Fat-specific: badge container and variants */
.fat-badges { display: flex; gap: var(--space-2); flex-wrap: wrap; flex-shrink: 0; }
.fat-category { font-size: var(--text-xs); text-transform: uppercase; letter-spacing: 0.05em; padding: 0.15rem 0.5rem; border-radius: var(--radius-sm); }
.fat-category-plant { color: var(--bg-primary); background: var(--accent-green); }
.fat-category-animal { color: var(--bg-primary); background: var(--accent-gold); }
.fat-badge { font-size: var(--text-2xs); text-transform: uppercase; letter-spacing: 0.03em; padding: 0.15rem 0.4rem; border-radius: var(--radius-sm); }
.fat-badge-allergen { color: var(--bg-primary); background: var(--danger); }
.fat-badge-sourcing { color: var(--text-primary); background: var(--bg-tertiary); border: 1px solid var(--border); }

/* Fat-specific: stats grid */
.fat-stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); gap: var(--space-2); padding: var(--space-3) var(--space-4); background: var(--bg-secondary); border-radius: var(--radius-md); }
.fat-stat { display: flex; flex-direction: column; align-items: center; text-align: center; }
.fat-stat-label { font-size: var(--text-xs); text-transform: uppercase; letter-spacing: 0.05em; color: var(--text-muted); margin-bottom: var(--space-1); }
a.fat-stat-label { text-decoration: none; border-bottom: 1px dotted var(--text-muted); transition: color 0.15s, border-color 0.15s; }
a.fat-stat-label:hover { color: var(--accent-gold); border-bottom-color: var(--accent-gold); }
.fat-stat-value { font-family: var(--font-mono); font-size: var(--text-xl); color: var(--text-primary); }

/* Fat-specific: fatty acid display */
.fatty-acid-grid {
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
}

.fatty-acid-item {
    display: grid;
    grid-template-columns: 1fr auto;
    grid-template-rows: auto auto;
    gap: 0.25rem 0.75rem;
    align-items: center;
}

.fatty-acid-name {
    font-size: var(--text-md);
    color: var(--text-secondary);
}

.fatty-acid-value {
    font-family: var(--font-mono);
    font-size: var(--text-md);
    color: var(--text-primary);
    text-align: right;
}

.fatty-acid-bar {
    grid-column: 1 / -1;
    height: 4px;
    background: var(--accent-green);
    border-radius: var(--radius-sm);
    opacity: 0.6;
}

.fat-no-data {
    color: var(--text-muted);
    font-style: italic;
    margin: 0;
}

/* ============================================
   Formulas Page - Entry Styles
   ============================================ */

/* Formula-specific: equation display */
.formula-equation { background: var(--bg-secondary); border-radius: var(--radius-md); padding: var(--space-3) var(--space-4); margin-bottom: var(--space-3); text-align: center; }
.formula-equation code { font-family: var(--font-mono); font-size: var(--text-3xl); color: var(--accent-gold); }
.formula-user-friendly { color: var(--text-secondary); margin-bottom: var(--space-3); }

/* Formula-specific: section boxes with tab-style headings */
.formula-variables,
.formula-example { margin-bottom: var(--space-3); }
.formula-section-heading { font-size: var(--text-xs); color: var(--text-muted); margin: 0; text-transform: uppercase; letter-spacing: 0.05em; background: var(--bg-secondary); display: inline-block; padding: 0.3rem 0.75rem; border-radius: var(--radius-md) var(--radius-md) 0 0; }
.formula-section-box { background: var(--bg-secondary); border-radius: 0 var(--radius-md) var(--radius-md) var(--radius-md); padding: var(--space-3) var(--space-4); font-size: var(--text-md); color: var(--text-secondary); }
.formula-section-box:last-child { margin-bottom: 0; }
.formula-variables dl { display: grid; grid-template-columns: max-content 1fr; gap: 0.25rem 1rem; }
.formula-variables dt { font-family: var(--font-mono); color: var(--accent-cream); }
.formula-variables dd { margin: 0; }
.example-scenario { font-weight: 500; color: var(--accent-cream); margin-bottom: var(--space-2); }
.example-steps { font-family: var(--font-mono); display: flex; flex-direction: column; gap: var(--space-1); }
.example-step { color: var(--text-primary); }

/* Formula-specific: range and technical */
.formula-range { display: inline-flex; gap: var(--space-2); background: var(--bg-secondary); border-radius: var(--radius-sm); padding: 0.35rem 0.75rem; font-size: var(--text-md); margin-bottom: var(--space-3); }
.formula-range .range-values { font-family: var(--font-mono); color: var(--accent-green); }
.formula-technical { margin: 0.75rem 0; }
.formula-technical-content { margin-top: var(--space-2); line-height: 1.7; }

/* ============================================
   References Page - Citation Styles
   ============================================ */

/* Citations details styling (uses .entry-details as base) */
.citations-details .entry-details-content {
    display: flex;
    flex-direction: column;
    gap: var(--space-3);
}

/* Citation items */
.citation-item {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: var(--radius-md);
    padding: var(--space-3) var(--space-4);
}

.citation-title {
    font-size: var(--text-xl);
    color: var(--text-primary);
    margin-bottom: var(--space-2);
}

a.citation-title {
    display: inline-flex;
    align-items: center;
    gap: var(--space-1);
    color: var(--accent-green);
    text-decoration: none;
}

a.citation-title:hover {
    text-decoration: underline;
}

a.citation-title .external-icon {
    font-size: var(--text-sm);
}

.citation-note {
    font-size: var(--text-md);
    color: var(--text-secondary);
    margin-top: var(--space-1);
}

.cited-by {
    font-size: var(--text-md);
    color: var(--text-secondary);
}

.cited-by-label {
    color: var(--text-muted);
    margin-right: 0.25rem;
}

.cited-by-link {
    color: var(--accent-gold);
    text-decoration: none;
}

.cited-by-link:hover {
    text-decoration: underline;
}

/* Optional label for subcontainer titles */
.optional-label {
    font-size: var(--text-base);
    color: var(--text-muted);
    font-weight: 400;
    font-family: var(--font-body);
}

/* Unified additive mode area */
.additive-mode-area {
    background: var(--bg-tertiary);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    padding: var(--space-4);
}

.additive-tabs {
    margin-bottom: var(--space-4);
    gap: var(--space-2);
}

.additive-tab {
    padding: var(--space-2) var(--space-4);
    font-size: var(--text-lg);
    border-radius: var(--radius-md);
    min-height: var(--size-btn-md);
}

.additive-tab.active {
    background: var(--accent-green-20);
    border-color: var(--accent-green);
    color: var(--text-primary);
    font-weight: 600;
}

.additive-selector {
    display: flex;
    gap: var(--space-2);
    margin-bottom: var(--space-4);
}

.additive-mode-area .empty-state,
.additive-mode-area .empty-state-small {
    padding: var(--space-4);
}

.additive-mode-area .empty-state p,
.additive-mode-area .empty-state-small p {
    margin-bottom: 0;
}

.additive-selector select {
    flex: 1;
}

/* Item row warning variants */
.item-row.warning {
    background: var(--accent-gold-10);
    border-color: var(--warning);
}

.item-row.danger {
    background: rgba(217, 123, 108, 0.1);
    border-color: var(--danger);
}

.empty-state-small {
    padding: var(--space-3);
    text-align: center;
    color: var(--text-muted);
}

.empty-state-small p {
    margin: 0;
}

/* Additive Info Panel */
.panel-safety {
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
}

.safety-item {
    font-size: var(--text-lg);
    color: var(--text-secondary);
    padding: 0.35rem 0;
    border-bottom: 1px solid var(--border-30);
}

.safety-item:last-child {
    border-bottom: none;
}

/* ============================================
   Create Recipe Section
   ============================================ */

.create-recipe-section {
    margin-top: var(--space-6);
    padding-top: var(--space-6);
    border-top: 1px solid var(--border);
    text-align: center;
}

.btn-large {
    padding: var(--space-3) var(--space-6);
    font-size: var(--text-xl);
    min-height: var(--size-btn-lg);
}

/* ============================================
   Final Recipe Display
   ============================================ */

#finalRecipeCard {
    background: var(--bg-card);
    border: 2px solid var(--accent-gold);
}

.final-recipe-content {
    padding: 0.5rem 0;
}

.recipe-prose {
    line-height: 1.7;
}

/* Qualitative Summary */
.qualitative-summary {
    color: var(--text-secondary);
    margin-bottom: var(--space-6);
    line-height: 1.6;
}

.qualitative-warnings {
    list-style: disc;
    padding-left: 1.25rem;
    margin: 0.75rem 0 1.5rem 0;
}

.qualitative-warnings li {
    margin-bottom: var(--space-2);
    color: var(--text-secondary);
    line-height: 1.5;
}

.qualitative-warnings li:last-child {
    margin-bottom: 0;
}

.recipe-section {
    margin-bottom: var(--space-6);
}

.recipe-section h4 {
    font-family: var(--font-display);
    font-size: var(--text-3xl);
    color: var(--accent-cream);
    margin-bottom: var(--space-3);
    padding-bottom: var(--space-2);
    border-bottom: 1px solid var(--border);
}

/* Ingredients List */
.ingredients-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.ingredients-list li {
    display: flex;
    gap: var(--space-3);
    padding: 0.5rem 0;
    border-bottom: 1px solid var(--border-30);
}

.ingredients-list li:last-child {
    border-bottom: none;
}

.ingredient-amount {
    font-family: var(--font-mono);
    font-size: var(--text-lg);
    color: var(--accent-gold);
    min-width: 80px;
}

.ingredient-name {
    color: var(--text-primary);
}

/* Procedure List */
.procedure-list {
    padding-left: 1.25rem;
    margin: 0;
}

.procedure-list li {
    margin-bottom: var(--space-4);
    padding-left: 0.5rem;
    color: var(--text-secondary);
    line-height: 1.6;
}

.procedure-list li:last-child {
    margin-bottom: 0;
}

.procedure-list li strong {
    color: var(--accent-cream);
    font-weight: 600;
}

.recipe-summary {
    margin-top: var(--space-6);
    padding: var(--space-5);
    background: var(--bg-secondary);
    border-radius: var(--radius-lg);
    border: 1px solid var(--border);
}

.recipe-summary h4 {
    font-family: var(--font-display);
    font-size: var(--text-3xl);
    color: var(--accent-cream);
    margin-bottom: var(--space-4);
}

.recipe-summary ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

.recipe-summary li {
    padding: 0.4rem 0;
    border-bottom: 1px solid var(--border-30);
    font-size: var(--text-xl);
    color: var(--text-secondary);
}

.recipe-summary li:last-child {
    border-bottom: none;
}

/* Fatty acid profile table within recipe-summary */
.fa-profile-table {
    width: 100%;
    border-collapse: collapse;
}

.fa-profile-table td {
    padding: 0.4rem 0;
    border-bottom: 1px solid var(--border-30);
    font-size: var(--text-xl);
    color: var(--text-secondary);
}

.fa-profile-table tr:last-child td {
    border-bottom: none;
}

.fa-profile-table .fa-value {
    text-align: right;
    width: 50px;
}

.sat-unsat-summary {
    margin-top: var(--space-3);
    padding-top: var(--space-3);
    border-top: 1px solid var(--border-30);
    font-size: var(--text-xl);
    color: var(--text-secondary);
}

/* Side-by-side layout for recipe summary and fatty acid profile */
.recipe-details-row {
    display: flex;
    gap: var(--space-4);
    margin-top: var(--space-6);
}

.recipe-details-row .recipe-summary {
    flex: 1;
    margin-top: 0;
}

@media (max-width: 768px) {
    .recipe-details-row {
        flex-direction: column;
    }

    .recipe-section h4 {
        font-size: var(--text-2xl);
    }

    .ingredient-amount {
        min-width: 70px;
        font-size: var(--text-md);
    }

    .procedure-list li {
        font-size: var(--text-lg);
    }

    .recipe-summary {
        padding: var(--space-4);
    }

    .recipe-summary h4 {
        font-size: var(--text-2xl);
    }
}

/* ============================================
   Science Section (Expandable)
   ============================================ */

.science-section {
    margin-top: var(--space-6);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    background: var(--bg-secondary);
}

.science-section summary {
    list-style: none;
    cursor: pointer;
    padding: 1rem 1.25rem;
    font-weight: 500;
    display: flex;
    align-items: center;
}

.science-section summary::-webkit-details-marker {
    display: none;
}

.science-section .details-toggle,
.science-section .details-hide {
    font-size: var(--text-2xl);
    color: var(--accent-gold);
}

.science-section .details-toggle::before {
    content: '▶';
    display: inline-block;
    margin-right: 0.5rem;
    transition: transform 0.2s;
    font-size: 0.6em;
}

.science-section[open] .details-toggle::before {
    transform: rotate(90deg);
}

.science-section .details-toggle:hover,
.science-section .details-hide:hover {
    text-decoration: underline;
}

.science-section .details-toggle {
    display: inline;
}

.science-section .details-hide {
    display: none;
}

.science-section[open] .details-toggle {
    display: none;
}

.science-section[open] .details-hide {
    display: inline;
}

.science-content {
    padding: 1rem 1.25rem;
    border-top: 1px solid var(--border);
}

.science-content h4 {
    margin: 0 0 1rem 0;
    color: var(--text-primary);
    font-size: var(--text-3xl);
}

.science-content .recipe-details-row {
    margin-top: 0;
    margin-bottom: var(--space-6);
}

.science-explanations {
    border-top: 1px solid var(--border);
    padding-top: var(--space-4);
}

.science-explanation {
    margin-bottom: var(--space-6);
    padding-bottom: var(--space-4);
    border-bottom: 1px solid var(--border-30);
}

.science-explanation:last-child {
    border-bottom: none;
    margin-bottom: 0;
    padding-bottom: 0;
}

.science-explanation h5 {
    margin: 0 0 0.5rem 0;
    color: var(--accent-gold);
    font-size: var(--text-2xl);
}

.science-explanation p {
    margin: 0 0 0.5rem 0;
    line-height: 1.6;
}

.science-explanation p:last-child {
    margin-bottom: 0;
}

.science-value-context {
    color: var(--text-secondary);
    font-size: var(--text-xl);
}

.science-citation {
    font-size: var(--text-md);
    color: var(--text-muted);
    margin-top: var(--space-3);
}

.science-citation a {
    color: var(--accent-green);
    text-decoration: none;
}

.science-citation a:hover {
    text-decoration: underline;
}

.science-learn-more {
    font-size: var(--text-md);
    color: var(--text-muted);
    margin-top: var(--space-2);
}

.science-learn-more a {
    color: var(--accent-cream);
    text-decoration: none;
}

.science-learn-more a:hover {
    text-decoration: underline;
}

@media (max-width: 768px) {
    .science-section summary {
        padding: var(--space-3) var(--space-4);
    }

    .science-content {
        padding: var(--space-3) var(--space-4);
    }

    .science-explanation h5 {
        font-size: var(--text-xl);
    }
}

/* ============================================
   Toast Notifications
   ============================================ */

.toast-container {
    position: fixed;
    top: 1rem;
    right: 1rem;
    z-index: 10000;
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
    max-width: 400px;
    pointer-events: none;
}

.toast {
    display: flex;
    align-items: flex-start;
    gap: var(--space-3);
    padding: 0.875rem 1rem;
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    opacity: 0;
    transform: translateX(100%);
    transition: opacity 0.2s, transform 0.2s;
    pointer-events: auto;
}

.toast-visible {
    opacity: 1;
    transform: translateX(0);
}

.toast-hiding {
    opacity: 0;
    transform: translateX(100%);
}

.toast-icon {
    flex-shrink: 0;
    font-size: var(--text-3xl);
    line-height: 1.4;
}

.toast-message {
    flex: 1;
    font-size: var(--text-lg);
    line-height: 1.4;
    color: var(--text-primary);
}

.toast-close {
    flex-shrink: 0;
    background: transparent;
    border: none;
    color: var(--text-muted);
    font-size: var(--text-4xl);
    cursor: pointer;
    padding: 0;
    line-height: 1;
    transition: color 0.2s;
}

.toast-close:hover {
    color: var(--text-primary);
}

/* Toast type variants */
.toast-info {
    border-left: 3px solid var(--accent-green);
}

.toast-success {
    border-left: 3px solid var(--success);
}

.toast-success .toast-icon {
    color: var(--success);
}

.toast-warning {
    border-left: 3px solid var(--warning);
}

.toast-error {
    border-left: 3px solid var(--danger);
}

.toast-error .toast-icon {
    color: var(--danger);
}

@media (max-width: 480px) {
    .toast-container {
        left: 1rem;
        right: 1rem;
        max-width: none;
    }

    .toast {
        transform: translateY(-100%);
    }

    .toast-visible {
        transform: translateY(0);
    }

    .toast-hiding {
        transform: translateY(-100%);
    }
}

/* ============================================
   Cupboard Cleaner Mode
   ============================================ */

.ratio-mode-toggle {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    margin-bottom: var(--space-4);
    font-size: var(--text-lg);
    cursor: pointer;
}

.ratio-mode-toggle input[type="checkbox"] {
    width: 1rem;
    height: 1rem;
    cursor: pointer;
}

.cupboard-actions {
    display: flex;
    gap: var(--space-2);
}

.cupboard-actions .btn {
    flex: 1;
}

/* Property comparison preview */
.cupboard-property-preview {
    margin: 1rem 0;
    padding: var(--space-4);
    background: var(--bg-input);
    border-radius: var(--radius-lg);
    border: 1px solid var(--border-30);
}

.property-comparison-header {
    display: grid;
    grid-template-columns: 1fr auto auto auto auto;
    gap: var(--space-3);
    font-size: var(--text-sm);
    font-weight: 600;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: var(--space-2);
    padding-bottom: var(--space-2);
    border-bottom: 1px solid var(--border-30);
}

.property-comparison-row {
    display: grid;
    grid-template-columns: 1fr auto auto auto auto;
    gap: var(--space-3);
    align-items: center;
    padding: 0.35rem 0;
    font-size: var(--text-lg);
}

.prop-name {
    color: var(--text-primary);
}

.prop-current,
.prop-improved {
    font-weight: 600;
    min-width: 2rem;
    text-align: right;
}

.prop-current.in-range,
.prop-improved.in-range {
    color: var(--success);
}

.prop-current.out-range,
.prop-improved.out-range {
    color: var(--danger);
}

.prop-arrow {
    color: var(--text-muted);
    font-size: var(--text-base);
}

.prop-diff {
    font-size: var(--text-base);
    min-width: 3rem;
}

.prop-diff.positive {
    color: var(--success);
}

.prop-diff.negative {
    color: var(--danger);
}

.prop-range {
    color: var(--text-muted);
    font-size: var(--text-base);
}

/* Responsive adjustments for build mode */
@media (max-width: 768px) {
    .build-mode-area,
    .additive-mode-area {
        padding: var(--space-3);
    }

    .build-mode-tabs,
    .additive-tabs {
        flex-wrap: wrap;
        gap: var(--space-1);
    }

    .build-mode-tab {
        flex: 1 1 45%;
        text-align: center;
        padding: 0.5rem 0.5rem;
        font-size: var(--text-base);
    }

    .additive-tab {
        flex: 1 1 30%;
        text-align: center;
        padding: 0.5rem 0.5rem;
        font-size: var(--text-base);
    }

    .property-comparison-header,
    .property-comparison-row {
        grid-template-columns: 1fr auto auto auto auto;
        gap: var(--space-2);
        font-size: var(--text-md);
    }
}

@media (max-width: 480px) {
    .build-mode-tab,
    .additive-tab {
        flex: 1 1 100%;
        padding: var(--space-2) var(--space-3);
        font-size: var(--text-base);
    }

    .cupboard-actions {
        flex-direction: column;
    }

    .property-comparison-header,
    .property-comparison-row {
        grid-template-columns: 1fr auto auto;
    }

    .prop-arrow,
    .prop-diff {
        display: none;
    }
}
