{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "oils.schema.json",
  "title": "Soap Making Oils Database",
  "description": "Schema for oils used in soap making calculations",
  "type": "object",
  "additionalProperties": {
    "$ref": "#/definitions/Oil"
  },
  "definitions": {
    "Oil": {
      "type": "object",
      "required": ["name", "sap", "fattyAcids", "iodine", "ins", "density", "usage", "description"],
      "properties": {
        "name": {
          "type": "string",
          "description": "Display name of the oil/fat",
          "minLength": 1
        },
        "sap": {
          "type": "object",
          "description": "Saponification values for different lye types",
          "required": ["naoh", "koh"],
          "properties": {
            "naoh": {
              "type": "number",
              "description": "Grams of NaOH per gram of oil",
              "minimum": 0,
              "maximum": 0.3
            },
            "koh": {
              "type": "number",
              "description": "Grams of KOH per gram of oil",
              "minimum": 0,
              "maximum": 0.4
            }
          },
          "additionalProperties": false
        },
        "fattyAcids": {
          "type": "object",
          "description": "Fatty acid percentages (0-100)",
          "properties": {
            "lauric": { "type": "number", "minimum": 0, "maximum": 100 },
            "myristic": { "type": "number", "minimum": 0, "maximum": 100 },
            "palmitic": { "type": "number", "minimum": 0, "maximum": 100 },
            "stearic": { "type": "number", "minimum": 0, "maximum": 100 },
            "ricinoleic": { "type": "number", "minimum": 0, "maximum": 100 },
            "oleic": { "type": "number", "minimum": 0, "maximum": 100 },
            "linoleic": { "type": "number", "minimum": 0, "maximum": 100 },
            "linolenic": { "type": "number", "minimum": 0, "maximum": 100 }
          },
          "additionalProperties": false
        },
        "iodine": {
          "type": "number",
          "description": "Iodine value",
          "minimum": 0,
          "maximum": 200
        },
        "ins": {
          "type": "number",
          "description": "INS value (sapKOH * 1000 - iodine)",
          "minimum": 0,
          "maximum": 400
        },
        "density": {
          "type": "number",
          "description": "Density in g/mL",
          "minimum": 0.7,
          "maximum": 1.1
        },
        "usage": {
          "type": "object",
          "description": "Recommended usage percentage range",
          "required": ["min", "max"],
          "properties": {
            "min": { "type": "integer", "minimum": 0, "maximum": 100 },
            "max": { "type": "integer", "minimum": 0, "maximum": 100 }
          },
          "additionalProperties": false
        },
        "description": {
          "type": "string",
          "description": "Brief description of the oil",
          "minLength": 1
        },
        "references": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["source", "section", "url"],
            "properties": {
              "source": { "type": "string" },
              "section": { "type": "string" },
              "url": { "type": "string", "format": "uri" }
            },
            "additionalProperties": false
          }
        },
        "dietary": {
          "type": "object",
          "description": "Dietary and ethical classification flags",
          "properties": {
            "animalBased": {
              "type": "boolean",
              "description": "True if derived from animal sources"
            },
            "ethicalConcerns": {
              "type": "boolean",
              "description": "True if there are significant ethical concerns (e.g., palm oil deforestation)"
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    }
  }
}
