{
  "$id": "fats.schema.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "additionalProperties": {
    "$ref": "#/definitions/Fat"
  },
  "definitions": {
    "Fat": {
      "additionalProperties": false,
      "properties": {
        "name": {
          "description": "Display name of the oil/fat",
          "minLength": 1,
          "type": "string"
        },
        "type": {
          "description": "Type classification",
          "const": "fat",
          "type": "string"
        },
        "description": {
          "description": "Brief description of the oil",
          "minLength": 1,
          "type": "string"
        },
        "details": {
          "additionalProperties": false,
          "description": "Technical details for the fat",
          "properties": {
            "sap": {
              "additionalProperties": false,
              "description": "Saponification values for different lye types",
              "properties": {
                "koh": {
                  "description": "Grams of KOH per gram of oil",
                  "maximum": 0.4,
                  "minimum": 0,
                  "type": "number"
                },
                "naoh": {
                  "description": "Grams of NaOH per gram of oil",
                  "maximum": 0.3,
                  "minimum": 0,
                  "type": "number"
                }
              },
              "required": ["naoh", "koh"],
              "type": "object"
            },
            "usage": {
              "additionalProperties": false,
              "description": "Recommended usage percentage range",
              "properties": {
                "max": {
                  "maximum": 100,
                  "minimum": 0,
                  "type": "integer"
                },
                "min": {
                  "maximum": 100,
                  "minimum": 0,
                  "type": "integer"
                }
              },
              "required": ["min", "max"],
              "type": "object"
            },
            "density": {
              "description": "Density in g/mL",
              "maximum": 1.1,
              "minimum": 0.7,
              "type": "number"
            },
            "iodine": {
              "description": "Iodine value",
              "maximum": 200,
              "minimum": 0,
              "type": "number"
            },
            "ins": {
              "description": "INS value (sapKOH * 1000 - iodine)",
              "maximum": 400,
              "minimum": 0,
              "type": "number"
            },
            "fattyAcids": {
              "additionalProperties": false,
              "description": "Fatty acid percentages (0-100)",
              "properties": {
                "caprylic": { "maximum": 100, "minimum": 0, "type": "number" },
                "capric": { "maximum": 100, "minimum": 0, "type": "number" },
                "lauric": { "maximum": 100, "minimum": 0, "type": "number" },
                "myristic": { "maximum": 100, "minimum": 0, "type": "number" },
                "palmitic": { "maximum": 100, "minimum": 0, "type": "number" },
                "palmitoleic": { "maximum": 100, "minimum": 0, "type": "number" },
                "stearic": { "maximum": 100, "minimum": 0, "type": "number" },
                "oleic": { "maximum": 100, "minimum": 0, "type": "number" },
                "linoleic": { "maximum": 100, "minimum": 0, "type": "number" },
                "linolenic": { "maximum": 100, "minimum": 0, "type": "number" },
                "arachidic": { "maximum": 100, "minimum": 0, "type": "number" },
                "behenic": { "maximum": 100, "minimum": 0, "type": "number" },
                "erucic": { "maximum": 100, "minimum": 0, "type": "number" },
                "ricinoleic": { "maximum": 100, "minimum": 0, "type": "number" }
              },
              "type": "object"
            },
            "sourcing": {
              "additionalProperties": false,
              "description": "Sourcing and production information",
              "properties": {
                "primaryRegions": {
                  "description": "Primary countries or regions where this ingredient is produced",
                  "items": { "type": "string", "minLength": 1 },
                  "type": "array"
                },
                "productionMethod": {
                  "description": "How the ingredient is extracted or produced",
                  "type": "string"
                },
                "supplyChainNotes": {
                  "description": "Additional notes about supply chain specifics",
                  "type": "string"
                }
              },
              "required": ["primaryRegions", "productionMethod"],
              "type": "object"
            }
          },
          "required": ["sap", "usage", "density", "iodine", "ins", "fattyAcids", "sourcing"],
          "type": "object"
        },
        "dietary": {
          "additionalProperties": false,
          "description": "Dietary classification flags",
          "properties": {
            "animalBased": {
              "description": "True if derived from animal sources",
              "type": "boolean"
            },
            "commonAllergen": {
              "description": "True if associated with common allergens (tree nuts, soy, etc.)",
              "type": "boolean"
            },
            "isExotic": {
              "description": "True if this is a specialty/exotic oil not commonly available",
              "type": "boolean"
            }
          },
          "type": "object"
        },
        "ethicalConcerns": {
          "additionalProperties": false,
          "description": "Ethical and sustainability concerns",
          "properties": {
            "environmental": {
              "description": "Environmental impact concerns",
              "items": { "type": "string" },
              "type": "array"
            },
            "social": {
              "description": "Social and labour-related concerns",
              "items": { "type": "string" },
              "type": "array"
            },
            "political": {
              "description": "Political or conflict-related concerns",
              "items": { "type": "string" },
              "type": "array"
            },
            "certifications": {
              "description": "Available certifications to address concerns",
              "items": { "type": "string" },
              "type": "array"
            },
            "notes": {
              "description": "Additional context about ethical considerations",
              "type": "string"
            }
          },
          "required": ["environmental", "social", "political", "certifications", "notes"],
          "type": "object"
        },
        "references": {
          "items": {
            "additionalProperties": false,
            "properties": {
              "sourceId": {
                "type": "string",
                "minLength": 1,
                "description": "ID of source in sources.json"
              },
              "section": {
                "type": "string",
                "description": "Specific section, chapter, or article identifier"
              },
              "url": {
                "type": "string",
                "format": "uri",
                "description": "Direct URL to the referenced content"
              },
              "note": {
                "type": "string",
                "description": "Additional context about this specific reference"
              }
            },
            "required": ["sourceId", "section"],
            "type": "object"
          },
          "type": "array"
        }
      },
      "required": ["name", "type", "description", "details", "ethicalConcerns"],
      "type": "object"
    }
  },
  "description": "Schema for fats used in soapmaking calculations",
  "title": "Soapmaking Fats Database",
  "type": "object"
}
